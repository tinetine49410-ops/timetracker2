<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>TimeTracker ‚Äî Connexion</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body{margin:0;font-family:Segoe UI,system-ui;background:#000;color:#fff;display:flex;align-items:center;justify-content:center;height:100vh}
    .card{background:#1e293b;padding:30px;border-radius:20px;width:100%;max-width:380px;box-shadow:0 20px 50px rgba(0,0,0,.6)}
    h2{text-align:center;margin:0 0 10px}
    input{width:100%;padding:14px;border-radius:12px;border:none;margin-top:10px;font-size:14px}
    button{width:100%;padding:14px;border-radius:12px;border:none;font-weight:800;margin-top:14px;cursor:pointer;font-size:14px}
    .green{background:#10b981;color:#000}
    .blue{background:#2563eb;color:#fff}
    .msg{margin-top:12px;text-align:center;font-size:13px;color:#fca5a5;min-height:18px}
    .ok{color:#86efac}
  </style>
</head>
<body>

  <div class="card">
    <h2>üîê Connexion</h2>
    <input id="email" type="email" placeholder="email" autocomplete="username" />
    <input id="password" type="password" placeholder="mot de passe" autocomplete="current-password" />
    <button id="btnLogin" class="green">Se connecter</button>
    <button id="btnSignup" class="blue">Cr√©er un compte</button>
    <div id="msg" class="msg"></div>
  </div>

  <script>
    // === CONFIG (TES VALEURS) ===
    const SUPABASE_URL = "https://nqmfrvargnwgcavmymwh.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_I2iHiULq2tMdZZpEUEKXgg_wer0lyAH";

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const $ = (id) => document.getElementById(id);
    const setMsg = (text, ok=false) => {
      $("msg").textContent = text || "";
      $("msg").className = ok ? "msg ok" : "msg";
    };

    document.addEventListener("DOMContentLoaded", async () => {
      // Si d√©j√† connect√© -> go app
      const { data: { session } } = await supabase.auth.getSession();
      if (session) location.href = "./app.html";

      $("btnSignup").addEventListener("click", async () => {
        setMsg("Cr√©ation du compte...");
        const email = $("email").value.trim();
        const password = $("password").value.trim();
        if (!email || !password) return setMsg("Email ou mot de passe manquant");

        const { error } = await supabase.auth.signUp({ email, password });
        if (error) return setMsg("‚ùå " + error.message);
        setMsg("‚úÖ Compte cr√©√©. Tu peux te connecter.", true);
      });

      $("btnLogin").addEventListener("click", async () => {
        setMsg("Connexion...");
        const email = $("email").value.trim();
        const password = $("password").value.trim();
        if (!email || !password) return setMsg("Email ou mot de passe manquant");

        const { error } = await supabase.auth.signInWithPassword({ email, password });
        if (error) return setMsg("‚ùå " + error.message);

        setMsg("‚úÖ Connexion r√©ussie", true);
        location.href = "./app.html";
      });
    });
  </script>
</body>
</html>
